---
title: "4. Análise do efeito dos ECEs sobre a agenda"
output: html_notebook
---

# 4. Análise do efeito dos ECEs sobre a agenda

Agora que já identificamos quais os tópicos dos documentos, vamos fazer uma análise da produção em relação ao total da produção.\
\
Na primeira, faremos a análise com toda a produção que menciona os termos procurados. Na segunda, vamos nos restringir à produção em projetos de lei

## Pacotes e bases de dado

```{r}
#install.packages(dplyr)
#install.packages("viridis")
```

```{r}
library(dplyr)
library(here)
library(tidyr)
library(data.table)
library(ggplot2)
library(lubridate)
```

## 4.1. Recuperando a base df_ols

Antes de começar, vamos simplificar a base DF para manter só as informações essenciais que serão utilizadas na análise:

```{r, echo = FALSE}
df_ols <- readRDS(here("Dados/df_ols.RDS"))

```

\

```{r}
library(viridis)
#Heatmap
heatmap <- df_ols %>% 
  ggplot(aes(x = Data, y = reorder(Cod_IBGE_Mun, agenda_clima))) +
  geom_tile(aes(fill = agenda_clima)) +   
  geom_tile(data = df_ols[df_ols$Desastre == 1, ], 
            aes(fill = NULL), 
            color = "red") +  
  scale_fill_viridis() +
  theme_classic() +
  theme(legend.position = "bottom") +
  labs(title = "Distribuição da apresentação de projetos, por município e data",
       y = "Código IBGE do Município", 
       x = "Data", 
       fill = "Percentual de projetos climáticos apresentados")
  
heatmap

ggsave(here("Figuras/4.1Heatmap_projetos_climaticos.png"), heatmap, height = 25, width = 10)
```
